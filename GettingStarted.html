
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Getting started &#8212; NonlinearTMM 0.1.dev1+g8cde62b documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API reference" href="Reference.html" />
    <link rel="prev" title="Introduction" href="Introduction.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading">¶</a></h1>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>Installation of NonlinearTMM package is possible through pip or from source
code.</p>
<p>Requirements:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.python.org/">Python &gt;= 3.6</a></p></li>
</ul>
<p>Dependencies:</p>
<ul class="simple">
<li><p>C++ code depends on <a class="reference external" href="http://eigen.tuxfamily.org/">Eigen library</a> (already included in package)</p></li>
</ul>
<p>Installation through pip is done like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>NonlinearTMM
</pre></div>
</div>
<p>Alternatively, it is possible to install the package form the source code by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>.
</pre></div>
</div>
<p>in the source code folder.</p>
</section>
<section id="package-structure">
<h2>Package structure<a class="headerlink" href="#package-structure" title="Permalink to this heading">¶</a></h2>
<p>The package has three main classes:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Material</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TMM</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SecondOrderNLTMM</span></code></p></li>
</ul>
<p>Class <code class="xref py py-class docutils literal notranslate"><span class="pre">Material</span></code> is responsible to represent the properties of optical
material. Mainly wavelength dependent refractive indices and second-order
suceptibility tensor for nonlinear processes.</p>
<p>Class <code class="xref py py-class docutils literal notranslate"><span class="pre">TMM</span></code> (alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">NonlinearTMM</span></code>) is has all the standard TMM features:</p>
<ul class="simple">
<li><p>Both p- and s-polarization</p></li>
<li><p>Arbritarty angle of incidence</p></li>
<li><p>Calculation of reflection, transmission and absorption of plane waves (<code class="xref any docutils literal notranslate"><span class="pre">GetIntensities</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">GetAbsorbedIntensity</span></code>)</p></li>
<li><p>Calculaion of electric and magnetic fields inside structure (<code class="xref any docutils literal notranslate"><span class="pre">GetFields</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">GetFields2D</span></code>)</p></li>
<li><p>Calculation of field enhancement (<code class="xref any docutils literal notranslate"><span class="pre">GetEnhancement</span></code>)</p></li>
<li><p>Sweep over any parameter (<code class="xref any docutils literal notranslate"><span class="pre">Sweep</span></code>)</p></li>
</ul>
<p>In addition to those standard features, the class has similar functionality to
work with waves with arbritarty profile (e.g. Gaussian beam). The configuration
of the beam is done through attribute <code class="xref any docutils literal notranslate"><span class="pre">wave</span></code> (see class <code class="xref any docutils literal notranslate"><span class="pre">_Wave</span></code>).
The interface for the calculations with arbritarty beams is similar to standard TMM:</p>
<ul class="simple">
<li><p>Calculation of reflection, transmission and absorption of beams (<code class="xref any docutils literal notranslate"><span class="pre">WaveGetPowerFlows</span></code>)</p></li>
<li><p>Calculaion of electric and magnetic fields inside structure (<code class="xref any docutils literal notranslate"><span class="pre">WaveGetFields2D</span></code>)</p></li>
<li><p>Calculation of field enhancement (<code class="xref any docutils literal notranslate"><span class="pre">WaveGetEnhancement</span></code>)</p></li>
<li><p>Sweep over any parameter (<code class="xref any docutils literal notranslate"><span class="pre">WaveSweep</span></code>)</p></li>
</ul>
<p>Finally, <code class="xref py py-class docutils literal notranslate"><span class="pre">SecondOrderNLTMM</span></code> class ic capable of calculating second-order
nonlinear processes like second-harmonic generation, sum-frequency generation and
difference frequency generation. This has similar interface as <a class="reference internal" href="TMM.html"><span class="doc">TMM</span></a> - it
supports both the plane waves and beams.</p>
</section>
<section id="standard-tmm">
<h2>Standard TMM<a class="headerlink" href="#standard-tmm" title="Permalink to this heading">¶</a></h2>
<section id="plane-waves-example">
<h3>Plane waves example<a class="headerlink" href="#plane-waves-example" title="Permalink to this heading">¶</a></h3>
<p>As an example three layer structure consisting of a prism (z &lt; 0), 50 nm thick silver
film and air is studied. Such kind of structure supports surface plasmon
resonance (SPP) if excited by p-polarized light and is named Kretschmann
configuration. The example code is shown bellow and could be divided into
following steps:</p>
<ol class="arabic simple">
<li><p>Specifying materials refractive indices.</p></li>
<li><p>Initializing <code class="xref py py-class docutils literal notranslate"><span class="pre">TMM</span></code>, setting params and adding layers.</p></li>
<li><p>By using <code class="xref any docutils literal notranslate"><span class="pre">Sweep</span></code> calculate the dependence of reflection, transmission and enhancment factor on the angle of incidence.</p></li>
<li><p>Find the plasmonic resonance by maximum enhancment.</p></li>
<li><p>Calculate 1D fields at plasmonic resonance by <code class="xref any docutils literal notranslate"><span class="pre">GetFields</span></code>.</p></li>
<li><p>Calculate 2D fields at plasmonic resonance by <code class="xref any docutils literal notranslate"><span class="pre">GetFields2D</span></code>.</p></li>
<li><p>Plot all results</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">NonlinearTMM</span> <span class="kn">import</span> <span class="n">TMM</span><span class="p">,</span> <span class="n">Material</span>

<span class="k">def</span> <span class="nf">CalcSpp</span><span class="p">():</span>
    <span class="c1"># Parameters</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="mf">532e-9</span>  <span class="c1"># Wavelength</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span>  <span class="c1"># Polarization</span>
    <span class="n">I0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Intensity of incident wave</span>
    <span class="n">metalD</span> <span class="o">=</span> <span class="mf">50e-9</span>  <span class="c1"># Metal film thickness</span>
    <span class="n">enhLayer</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Measure enhancment in the last layer</span>
    <span class="n">ths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>  <span class="c1"># Angle of incidences</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>  <span class="c1"># Field calculation coordinates</span>
    <span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2e-6</span><span class="p">,</span> <span class="mf">2e-6</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>  <span class="c1"># Field calculation coordinates</span>
    
    <span class="c1"># Specify materials</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">prism</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">Static</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ag</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">Static</span><span class="p">(</span><span class="mf">0.054007</span> <span class="o">+</span> <span class="mf">3.4290</span><span class="n">j</span><span class="p">)</span>  <span class="c1"># Johnson &amp; Christie @ 532nm</span>
    <span class="n">dielectric</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">Static</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    
    <span class="c1"># Init TMM</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">tmm</span> <span class="o">=</span> <span class="n">TMM</span><span class="p">(</span><span class="n">wl</span> <span class="o">=</span> <span class="n">wl</span><span class="p">,</span> <span class="n">pol</span> <span class="o">=</span> <span class="n">pol</span><span class="p">,</span> <span class="n">I0</span> <span class="o">=</span> <span class="n">I0</span><span class="p">)</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">AddLayer</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">prism</span><span class="p">)</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">AddLayer</span><span class="p">(</span><span class="n">metalD</span><span class="p">,</span> <span class="n">ag</span><span class="p">)</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">AddLayer</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">dielectric</span><span class="p">)</span>
    
    <span class="c1"># Solve</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    
    <span class="c1"># Calculate reflection, transmission and field enhancement</span>
    <span class="n">betas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ths</span><span class="p">)</span> <span class="o">*</span> <span class="n">prism</span><span class="o">.</span><span class="n">GetN</span><span class="p">(</span><span class="n">wl</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
    <span class="n">sweepRes</span> <span class="o">=</span> <span class="n">tmm</span><span class="o">.</span><span class="n">Sweep</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">outEnh</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">layerNr</span> <span class="o">=</span> <span class="n">enhLayer</span><span class="p">)</span> 
    
    <span class="c1"># Calculate fields at the reflection dip (excitation of SPPs)</span>
    <span class="n">betaMaxEnh</span> <span class="o">=</span> <span class="n">betas</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sweepRes</span><span class="o">.</span><span class="n">enh</span><span class="p">)]</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">Solve</span><span class="p">(</span><span class="n">beta</span> <span class="o">=</span> <span class="n">betaMaxEnh</span><span class="p">)</span>
    
    <span class="c1"># Calculate 1D fields</span>
    <span class="n">fields1D</span> <span class="o">=</span> <span class="n">tmm</span><span class="o">.</span><span class="n">GetFields</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
    
    <span class="c1"># Calculate 2D fields</span>
    <span class="n">fields2D</span> <span class="o">=</span> <span class="n">tmm</span><span class="o">.</span><span class="n">GetFields2D</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
    
    <span class="c1"># Ploting</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">thMaxEnh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">betaMaxEnh</span> <span class="o">/</span> <span class="n">prism</span><span class="o">.</span><span class="n">GetN</span><span class="p">(</span><span class="n">wl</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
    
    <span class="c1"># Reflection / transmission</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">Ir</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;R&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">It</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;T&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">thMaxEnh</span><span class="p">),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$ ($\degree$)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Intensity (a.u)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># Field enhancement</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">enh</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">thMaxEnh</span><span class="p">),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$ ($\degree$)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Field enhancement&quot;</span><span class="p">)</span>
    
    <span class="c1"># Fields 1D</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1e6</span> <span class="o">*</span> <span class="n">zs</span><span class="p">,</span> <span class="n">fields1D</span><span class="o">.</span><span class="n">E</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$E_x$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1e6</span> <span class="o">*</span> <span class="n">zs</span><span class="p">,</span> <span class="n">fields1D</span><span class="o">.</span><span class="n">E</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$E_z$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1e6</span> <span class="o">*</span> <span class="n">zs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fields1D</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;‖E‖&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z (μm)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(V/m)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># Fields 2D</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="mf">1e6</span> <span class="o">*</span> <span class="n">zs</span><span class="p">,</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">xs</span><span class="p">,</span> <span class="n">fields2D</span><span class="o">.</span><span class="n">Ez</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">rasterized</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z (μm)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;x (μm)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$E_z$ (V/m)&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">CalcSpp</span><span class="p">()</span>
</pre></div>
</div>
<p>The results of the calculations are shown bellow. Indeed there is a sharrp dip
in the reflection (R) near the angle of incidence ca 44 degrees. At the same angle
the field enhancement factor is maximum and is more than 12 times. In the second
the results of the fields calculations at plasmonic resonance is presented. Indeed,
surface wave on the silver-air interface is excited and characteristic pattern of
fields for SPP is visible.</p>
<img alt="_images/TMM-example.png" src="_images/TMM-example.png" />
</section>
<section id="gaussian-wave-example">
<h3>Gaussian wave example<a class="headerlink" href="#gaussian-wave-example" title="Permalink to this heading">¶</a></h3>
<p>Previous example was entirely about standard TMM. Now, the calculations are
extended to the beams, in this case Gaussian beam. The steps of the calculations
remain the same, except <code class="xref py py-class docutils literal notranslate"><span class="pre">_Wave</span></code> parameters must be set (<code class="xref py py-class docutils literal notranslate"><span class="pre">TMM</span></code> has
attribute <code class="xref any docutils literal notranslate"><span class="pre">TMM.wave</span></code>). Gaussian beam power is set to 10 mW and waist size
to 10 μm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">NonlinearTMM</span> <span class="kn">import</span> <span class="n">TMM</span><span class="p">,</span> <span class="n">Material</span>

<span class="k">def</span> <span class="nf">CalcSppGaussianBeam</span><span class="p">():</span>
    <span class="c1"># Parameters</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="mf">532e-9</span>  <span class="c1"># Wavelength</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span>  <span class="c1"># Polarization</span>
    <span class="n">I0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Intensity of incident wave</span>
    <span class="n">metalD</span> <span class="o">=</span> <span class="mf">50e-9</span>  <span class="c1"># Metal film thickness</span>
    <span class="n">enhLayer</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Measure enhancment in the last layer</span>
    <span class="n">ths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>  <span class="c1"># Angle of incidences</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">50e-6</span><span class="p">,</span> <span class="mf">50e-6</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>  <span class="c1"># Field calculation coordinates</span>
    <span class="n">zs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">25e-6</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>  <span class="c1"># Field calculation coordinates</span>
    <span class="n">waveType</span> <span class="o">=</span> <span class="s2">&quot;gaussian&quot;</span>  <span class="c1"># Wave type</span>
    <span class="n">pwr</span> <span class="o">=</span> <span class="mf">10e-3</span>  <span class="c1"># Beam power [W]</span>
    <span class="n">w0</span> <span class="o">=</span> <span class="mf">10e-6</span>  <span class="c1"># Beam waist size</span>
    
    <span class="c1"># Specify materials</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">prism</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">Static</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ag</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">Static</span><span class="p">(</span><span class="mf">0.054007</span> <span class="o">+</span> <span class="mf">3.4290</span><span class="n">j</span><span class="p">)</span>  <span class="c1"># Johnson &amp; Christie @ 532nm</span>
    <span class="n">dielectric</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">Static</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    
    <span class="c1"># Init TMM</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">tmm</span> <span class="o">=</span> <span class="n">TMM</span><span class="p">(</span><span class="n">wl</span> <span class="o">=</span> <span class="n">wl</span><span class="p">,</span> <span class="n">pol</span> <span class="o">=</span> <span class="n">pol</span><span class="p">,</span> <span class="n">I0</span> <span class="o">=</span> <span class="n">I0</span><span class="p">)</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">AddLayer</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">prism</span><span class="p">)</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">AddLayer</span><span class="p">(</span><span class="n">metalD</span><span class="p">,</span> <span class="n">ag</span><span class="p">)</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">AddLayer</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">dielectric</span><span class="p">)</span>
    
    <span class="c1"># Init wave params</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">SetParams</span><span class="p">(</span><span class="n">waveType</span> <span class="o">=</span> <span class="n">waveType</span><span class="p">,</span> <span class="n">w0</span> <span class="o">=</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pwr</span> <span class="o">=</span> <span class="n">pwr</span><span class="p">,</span> \
                       <span class="n">dynamicMaxX</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">maxX</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="c1"># Solve</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    
    <span class="c1"># Calculate reflection, transmission and field enhancement</span>
    <span class="n">betas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ths</span><span class="p">)</span> <span class="o">*</span> <span class="n">prism</span><span class="o">.</span><span class="n">GetN</span><span class="p">(</span><span class="n">wl</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
    <span class="n">sweepRes</span> <span class="o">=</span> <span class="n">tmm</span><span class="o">.</span><span class="n">WaveSweep</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">outEnh</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">layerNr</span> <span class="o">=</span> <span class="n">enhLayer</span><span class="p">)</span> 
    
    <span class="c1"># Calculate fields at the reflection dip (excitation of SPPs)</span>
    <span class="n">betaMaxEnh</span> <span class="o">=</span> <span class="n">betas</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sweepRes</span><span class="o">.</span><span class="n">enh</span><span class="p">)]</span>
    <span class="n">tmm</span><span class="o">.</span><span class="n">Solve</span><span class="p">(</span><span class="n">beta</span> <span class="o">=</span> <span class="n">betaMaxEnh</span><span class="p">)</span>
    <span class="n">fields2D</span> <span class="o">=</span> <span class="n">tmm</span><span class="o">.</span><span class="n">WaveGetFields2D</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
    
    <span class="c1"># Ploting</span>
    <span class="c1">#---------------------------------------------------------------------------</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">rowspan</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">thMaxEnh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">betaMaxEnh</span> <span class="o">/</span> <span class="n">prism</span><span class="o">.</span><span class="n">GetN</span><span class="p">(</span><span class="n">wl</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
    
    <span class="c1"># Reflection / transmission</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">Pi</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$P_i$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">Pr</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$P_r$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">Pt</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$P_t$&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">thMaxEnh</span><span class="p">),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$ ($\degree$)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Power (mW)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># Field enhancement</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ths</span><span class="p">),</span> <span class="n">sweepRes</span><span class="o">.</span><span class="n">enh</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">thMaxEnh</span><span class="p">),</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\theta$ ($\degree$)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Field enhancement&quot;</span><span class="p">)</span>
    
    <span class="c1"># Fields 2D</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="mf">1e6</span> <span class="o">*</span> <span class="n">zs</span><span class="p">,</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="n">xs</span><span class="p">,</span> <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">fields2D</span><span class="o">.</span><span class="n">EN</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">5e1</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;z (μm)&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;x (μm)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$‖E‖$ (kV/m)&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">CalcSppGaussianBeam</span><span class="p">()</span>
</pre></div>
</div>
<p>The results of those calculations are bellow. Despite the fact, that the structure
is the same, the dip in the reflection is different. The reason for this behaviour
is that as the resonances of SPPs are narrow, they also require well collimated
beam to excite them. Also field enhancment is ca 3 times lower, as expected. On
the right side, the electrical field norm is shown. It is clearly visible, that
Gaussian beam is incident form the left, and it gets reflected from the metal film (z = 0).
Part of the energy is transmitted to excite SPPs at the metal-air interface. The
excited SPPs are propagating on the metal film and are absorbe after ca 20 μm of
propagation.</p>
<img alt="_images/TMMForWaves-example.png" src="_images/TMMForWaves-example.png" />
</section>
</section>
<section id="second-order-nonlinear-tmm">
<h2>Second-order nonlinear TMM<a class="headerlink" href="#second-order-nonlinear-tmm" title="Permalink to this heading">¶</a></h2>
<section id="id1">
<h3>Plane waves example<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p>Will be added in near future.</p>
</section>
<section id="id2">
<h3>Gaussian wave example<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>Will be added in near future.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">NonlinearTMM</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#package-structure">Package structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#standard-tmm">Standard TMM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plane-waves-example">Plane waves example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gaussian-wave-example">Gaussian wave example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#second-order-nonlinear-tmm">Second-order nonlinear TMM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Plane waves example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Gaussian wave example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Reference.html">API reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Introduction.html" title="previous chapter">Introduction</a></li>
      <li>Next: <a href="Reference.html" title="next chapter">API reference</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Ardi Loot.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/GettingStarted.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>